<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Back Job Details - MechConnect</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/geist-sans@5.0.1/index.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Geist Sans', 'system-ui', 'sans-serif'],
                    },
                    fontSize: {
                        'xs': ['0.75rem', { lineHeight: '1rem' }],
                        'sm': ['0.875rem', { lineHeight: '1.25rem' }],
                        'base': ['1rem', { lineHeight: '1.5rem' }],
                        'lg': ['1.125rem', { lineHeight: '1.75rem' }],
                    },
                    colors: {
                        orange: {
                            500: '#f97316',
                            600: '#ea580c',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .detail-card {
            transition: all 0.3s ease;
        }
        
        .image-preview {
            transition: all 0.3s ease;
        }
        
        .image-preview:hover {
            transform: scale(1.05);
        }
        
        .status-pending {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .status-approved {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .status-completed {
            background: linear-gradient(135deg, #6b7280, #4b5563);
        }
        
        .timeline-item {
            position: relative;
            padding-left: 2rem;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 0.5rem;
            top: 0.5rem;
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            background-color: #f97316;
        }
        
        .timeline-item:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 0.875rem;
            top: 1.25rem;
            bottom: -1rem;
            width: 2px;
            background-color: #e5e7eb;
        }
        
        .action-btn {
            transition: all 0.2s ease;
        }
        
        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans">
    <!-- Top Bar -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-10">
        <div class="max-w-6xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <!-- Back Button -->
                <button onclick="window.history.back()" class="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-all duration-200 group">
                    <span class="material-icons-round text-lg group-hover:-translate-x-0.5 transition-transform">arrow_back</span>
                    <span class="text-sm font-medium">Back</span>
                </button>
                
                <!-- Page Title -->
                <h1 class="text-xl font-bold text-gray-900">Back Job Details</h1>
                
                <!-- Action Menu -->
                <div class="relative">
                    <button id="action-menu-btn" class="flex items-center gap-1 text-gray-600 hover:text-gray-900">
                        <span class="material-icons-round">more_vert</span>
                    </button>
                    <div id="action-menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-20">
                        <button onclick="shareBackJob()" class="flex items-center gap-2 w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            <span class="material-icons-round text-sm">share</span>
                            <span>Share Details</span>
                        </button>
                        <button onclick="printDetails()" class="flex items-center gap-2 w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            <span class="material-icons-round text-sm">print</span>
                            <span>Print</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-6">
        <!-- Status Banner -->
        <div class="status-approved text-white rounded-2xl p-4 mb-6 flex items-center justify-between shadow-md">
            <div class="flex items-center gap-3">
                <span class="material-icons-round text-xl">build</span>
                <div>
                    <div class="font-semibold">Back Job Approved</div>
                    <div class="text-sm opacity-90">Scheduled for Jan 20, 2024 at 10:00 AM</div>
                </div>
            </div>
            <div class="text-right">
                <div class="font-mono font-bold text-lg">BJ-2024-002</div>
                <div class="text-sm opacity-90">Submitted Jan 16, 2024</div>
            </div>
        </div>

        <!-- Back Job Details Card -->
        <div class="detail-card bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6">
            <!-- Header -->
            <div class="flex flex-col md:flex-row md:items-start justify-between gap-4 mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">AC Not Cooling Properly</h2>
                    <div class="flex items-center gap-4 text-sm text-gray-600">
                        <div class="flex items-center gap-1">
                            <span class="material-icons-round text-base">handyman</span>
                            <span>David Chen</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <span class="material-icons-round text-base">receipt</span>
                            <span>Original Service: BK-2024-003</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <span class="material-icons-round text-base">schedule</span>
                            <span>Urgency: Medium</span>
                        </div>
                    </div>
                </div>
                
                <div class="flex gap-2">
                    <button onclick="rescheduleBackJob()" class="action-btn bg-orange-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-orange-600 transition-colors flex items-center gap-2">
                        <span class="material-icons-round text-sm">schedule</span>
                        <span>Reschedule</span>
                    </button>
                </div>
            </div>

            <!-- Mechanic Contact Info -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <span class="material-icons-round text-orange-500">contact_phone</span>
                    Mechanic Contact
                </h3>
                <div class="bg-blue-50 rounded-xl border border-blue-200 p-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <div class="text-sm font-medium text-blue-900 mb-1">Mechanic Name</div>
                            <div class="text-blue-700">David Chen</div>
                        </div>
                        <div>
                            <div class="text-sm font-medium text-blue-900 mb-1">Contact Number</div>
                            <div class="text-blue-700 font-mono">+63 912 345 6789</div>
                        </div>
                    </div>
                    <div class="mt-3 text-xs text-blue-600">
                        <span class="material-icons-round text-xs align-middle">info</span>
                        Please call during business hours (8:00 AM - 6:00 PM)
                    </div>
                </div>
            </div>

            <!-- Issue Description -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <span class="material-icons-round text-orange-500">description</span>
                    Issue Description
                </h3>
                <div class="bg-gray-50 rounded-xl border border-gray-200 p-4">
                    <p class="text-gray-700">
                        AC system was serviced but still not cooling to the expected temperature. 
                        Airflow seems weaker than before the service. The AC takes longer to cool the cabin 
                        and doesn't reach the same low temperatures as it did before the service.
                    </p>
                    <div class="mt-3 flex items-center gap-4 text-sm text-gray-600">
                        <div class="flex items-center gap-1">
                            <span class="material-icons-round text-base text-orange-500">category</span>
                            <span>Issue Type: Incomplete Work</span>
                        </div>
                        <div class="flex items-center gap-1">
                            <span class="material-icons-round text-base text-orange-500">flag</span>
                            <span>Urgency: Medium</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Photos -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <span class="material-icons-round text-orange-500">photo_library</span>
                    Photo Evidence
                </h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="image-preview bg-gray-100 rounded-xl overflow-hidden cursor-pointer aspect-video">
                        <img src="../../../imgs/service_deafault_2.png" alt="AC Issue" class="w-full h-full object-cover">
                    </div>
                    <div class="image-preview bg-gray-100 rounded-xl overflow-hidden cursor-pointer aspect-video">
                        <img src="../../../imgs/service_deafault_2.png" alt="Temperature reading" class="w-full h-full object-cover">
                    </div>
                    <div class="image-preview bg-gray-100 rounded-xl overflow-hidden cursor-pointer aspect-video flex items-center justify-center text-gray-400">
                        <div class="text-center">
                            <span class="material-icons-round text-4xl">add</span>
                            <div class="text-sm mt-1">Add more photos</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scheduling Information -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <span class="material-icons-round text-orange-500">schedule</span>
                    Scheduling Information
                </h3>
                <div class="bg-blue-50 rounded-xl border border-blue-200 p-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <div class="text-sm font-medium text-blue-900 mb-1">Scheduled Date & Time</div>
                            <div class="text-blue-700">January 20, 2024 at 10:00 AM</div>
                        </div>
                        <div>
                            <div class="text-sm font-medium text-blue-900 mb-1">Estimated Duration</div>
                            <div class="text-blue-700">1-2 hours</div>
                        </div>
                        <div>
                            <div class="text-sm font-medium text-blue-900 mb-1">Service Location</div>
                            <div class="text-blue-700">Same as previous service</div>
                        </div>
                        <div>
                            <div class="text-sm font-medium text-blue-900 mb-1">Contact Method</div>
                            <div class="text-blue-700">Phone Call</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mechanic's Response -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <span class="material-icons-round text-orange-500">chat</span>
                    Mechanic's Response
                </h3>
                <div class="bg-green-50 rounded-xl border border-green-200 p-4">
                    <div class="flex items-start gap-3">
                        <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">
                            <span class="material-icons-round text-green-500">handyman</span>
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <div class="font-medium text-green-900">David Chen</div>
                                <div class="text-xs text-green-700">Jan 16, 2024 • 3:45 PM</div>
                            </div>
                            <p class="text-green-800 text-sm">
                                "I apologize for the issue with your AC system. Based on your description and photos, 
                                it seems there might be an issue with the refrigerant charge or a potential blockage 
                                in the system. I'll bring additional tools to properly diagnose and fix this during 
                                our scheduled appointment. There will be no additional charge for this back job service."
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Status Timeline -->
            <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">
                    <span class="material-icons-round text-orange-500">history</span>
                    Status Timeline
                </h3>
                <div class="bg-gray-50 rounded-xl border border-gray-200 p-4">
                    <div class="space-y-4">
                        <div class="timeline-item">
                            <div class="text-sm font-medium text-gray-900">Back Job Approved</div>
                            <div class="text-xs text-gray-500">January 17, 2024 • 9:20 AM</div>
                            <div class="text-sm text-gray-700 mt-1">Mechanic reviewed your request and approved the back job service.</div>
                        </div>
                        <div class="timeline-item">
                            <div class="text-sm font-medium text-gray-900">Back Job Submitted</div>
                            <div class="text-xs text-gray-500">January 16, 2024 • 2:30 PM</div>
                            <div class="text-sm text-gray-700 mt-1">You submitted this back job request for AC system issues.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4">
            <button onclick="contactSupport()" class="action-btn bg-gray-200 text-gray-800 px-6 py-3 rounded-xl text-base font-medium hover:bg-gray-300 transition-colors flex items-center justify-center gap-2 flex-1">
                <span class="material-icons-round text-base">help</span>
                <span>Contact Support</span>
            </button>
            <button onclick="rescheduleBackJob()" class="action-btn bg-orange-500 text-white px-6 py-3 rounded-xl text-base font-medium hover:bg-orange-600 transition-colors flex items-center justify-center gap-2 flex-1">
                <span class="material-icons-round text-base">schedule</span>
                <span>Reschedule</span>
            </button>
            <button onclick="rateService()" class="action-btn bg-green-500 text-white px-6 py-3 rounded-xl text-base font-medium hover:bg-green-600 transition-colors flex items-center justify-center gap-2 flex-1">
                <span class="material-icons-round text-base">star</span>
                <span>Rate Service</span>
            </button>
        </div>
    </main>

    <!-- Image Modal -->
    <div id="image-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="relative max-w-4xl max-h-full mx-4">
            <img id="modal-image" src="" alt="Enlarged view" class="max-w-full max-h-full object-contain rounded-lg">
            <button class="absolute top-4 right-4 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-75 transition-all"
                    onclick="closeImageModal()">
                <span class="material-icons-round">close</span>
            </button>
        </div>
    </div>

    <script>
        // Action menu toggle
        document.getElementById('action-menu-btn').addEventListener('click', function() {
            const menu = document.getElementById('action-menu');
            menu.classList.toggle('hidden');
        });

        // Close menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('#action-menu') && !e.target.closest('#action-menu-btn')) {
                document.getElementById('action-menu').classList.add('hidden');
            }
        });

        // Image preview modal
        document.addEventListener('click', function(e) {
            if (e.target.closest('.image-preview')) {
                const imgSrc = e.target.closest('.image-preview').querySelector('img')?.src;
                if (imgSrc) {
                    openImageModal(imgSrc);
                }
            }
        });

        function openImageModal(src) {
            document.getElementById('modal-image').src = src;
            document.getElementById('image-modal').classList.remove('hidden');
        }

        function closeImageModal() {
            document.getElementById('image-modal').classList.add('hidden');
        }

        // Action functions
        function callMechanic() {
            const phoneNumber = "+639123456789";
            if (confirm(`Call mechanic David Chen at ${phoneNumber}?`)) {
                window.location.href = `tel:${phoneNumber}`;
            }
        }

        function rescheduleBackJob() {
            showMessage('Opening reschedule form', 'success');
            setTimeout(() => {
                window.location.href = 'reschedule-backjob.html?id=BJ-2024-002';
            }, 500);
        }

        function rateService() {
            showMessage('Opening rating form', 'success');
            setTimeout(() => {
                window.location.href = 'rate-service.html?backjob=BJ-2024-002';
            }, 500);
        }

        function contactSupport() {
            const supportNumber = "+639001234567";
            if (confirm(`Call MechConnect support at ${supportNumber}?`)) {
                window.location.href = `tel:${supportNumber}`;
            }
        }

        function shareBackJob() {
            if (navigator.share) {
                navigator.share({
                    title: 'Back Job Details - BJ-2024-002',
                    text: 'Check out my back job details on MechConnect',
                    url: window.location.href,
                })
                .then(() => console.log('Successful share'))
                .catch((error) => console.log('Error sharing', error));
            } else {
                // Fallback for browsers that don't support Web Share API
                navigator.clipboard.writeText(window.location.href).then(() => {
                    showMessage('Link copied to clipboard', 'success');
                });
            }
        }

        function printDetails() {
            window.print();
        }

        // Show message toast
        function showMessage(message, type) {
            const messageEl = document.createElement("div");
            messageEl.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === "success"
                    ? "bg-green-500 text-white"
                    : "bg-red-500 text-white"
            }`;
            messageEl.innerHTML = `<div class="flex items-center gap-2"><span class="material-icons-round">${
                type === "success" ? "check_circle" : "error"
            }</span> ${message}</div>`;
            document.body.appendChild(messageEl);

            setTimeout(() => {
                messageEl.remove();
            }, 3000);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Parse URL parameters to load specific back job data
            const urlParams = new URLSearchParams(window.location.search);
            const backjobId = urlParams.get('id');
            
            if (backjobId) {
                // In a real app, this would fetch back job details from an API
                console.log(`Loading details for back job: ${backjobId}`);
            }
        });
    </script>
</body>
</html>